<div class="container mt-4 d-flex">
    <div class="left-panel" style="flex: 2; padding-right: 20px;">
        <h3>Order Items</h3>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Barcode</th>
                    <th>Quantity</th>
                    <th>Selling Price</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let item of orderItems; let i = index">
                    <td>{{ item.barcode }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>{{ item.sellingPrice }}</td>
                    <td>
                        <button type="button" class="btn btn-danger btn-sm" (click)="removeOrderItem(i)" *ngIf="orderItems.length > 1">❌ Remove</button>
                    </td>
                </tr>
            </tbody>
        </table>
        <button type="submit" class="btn btn-success" (click)="submitForm()">Submit Order</button>
    </div>

    <div class="right-panel" style="flex: 1;">
        <h3>Create Order</h3>
        <form (ngSubmit)="submitForm()" #orderForm="ngForm">
            <!-- Customer Details -->
            <div class="mb-3">
                <label class="form-label">Customer Name</label>
                <input type="text" class="form-control" [(ngModel)]="customer.name" name="customerName" required>
                <div *ngIf="orderForm.controls['customerName']?.invalid && orderForm.controls['customerName']?.touched" class="text-danger">
                    Customer Name is required.
                </div>
            </div>
            <div class="mb-3">
                <label class="form-label">Customer Phone</label>
                <input type="tel" class="form-control" [(ngModel)]="customer.phone" name="customerPhone" required pattern="^[0-9]{10}$">
                <div *ngIf="orderForm.controls['customerPhone']?.invalid && orderForm.controls['customerPhone']?.touched" class="text-danger">
                    <div *ngIf="orderForm.controls['customerPhone']?.errors?.['required']">Customer Phone is required.</div>
                    <div *ngIf="orderForm.controls['customerPhone']?.errors?.['pattern']">Please enter a valid 10-digit phone number.</div>
                </div>
            </div>

            <!-- Order Item Form -->
            <div class="border p-3 mb-3">
                <h5>Add Sale Item</h5>
                <div class="mb-3">
                    <label class="form-label">Barcode</label>
                    <input type="text" class="form-control" [(ngModel)]="newItem.barcode" name="newBarcode" required>
                    <div *ngIf="orderForm.controls['newBarcode']?.invalid && orderForm.controls['newBarcode']?.touched" class="text-danger">
                        Barcode is required.
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Quantity</label>
                    <input type="number" class="form-control" [(ngModel)]="newItem.quantity" name="newQuantity" required min="1">
                    <div *ngIf="orderForm.controls['newQuantity']?.invalid && orderForm.controls['newQuantity']?.touched" class="text-danger">
                        <div *ngIf="orderForm.controls['newQuantity']?.errors?.['required']">Quantity is required.</div>
                    </div>
                    <div *ngIf="newItem.quantity <= 0" class="text-danger">
                        Quantity must be greater than 0.
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Selling Price</label>
                    <input type="number" class="form-control" [(ngModel)]="newItem.sellingPrice" name="newSellingPrice" required min="0">
                    <div *ngIf="orderForm.controls['newSellingPrice']?.invalid && orderForm.controls['newSellingPrice']?.touched" class="text-danger">
                        <div *ngIf="orderForm.controls['newSellingPrice']?.errors?.['required']">Selling Price is required.</div>
                        <div *ngIf="orderForm.controls['newSellingPrice']?.errors?.['min']">Selling Price must be at least 0.</div>
                    </div>
                    <div *ngIf="newItem.sellingPrice < 0" class="text-danger">
                        Selling Price cannot be negative.
                    </div>
                </div>
                <button type="button" class="btn btn-secondary" (click)="addOrderItem()">➕ Add Sale Item</button>
            </div>
        </form>
    </div>
</div>
